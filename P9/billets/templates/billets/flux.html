{% extends "billets/base_generic.html" %}

{% block title %}Flux LITRevu{% endblock %}

{% block content %}
<h2>Flux</h2>

<ul>
  <!-- {# Boucle sur tous les éléments du flux trié (billets et commentaires) #} -->
  {% for item in flux %}
    <li>
      <!-- {# Vérifie si l’élément est un billet #} -->
      {% if item.is_billet %}
        <!-- Affiche le titre et l’auteur du billet -->
        Billet : {{ item.title }} - {{ item.user.username }}
        <!-- {# Affiche les liens de modification/suppression si c’est l’utilisateur courant #} -->
        {% if item.user == request.user %}
          <a href="{% url 'billets:modifier' item.pk %}">Modifier</a>
          <a href="{% url 'billets:supprimer' item.pk %}">Supprimer</a>
        {% endif %}
      <!-- Sinon, c’est un commentaire -->
      {% else %}
        <!-- Affiche le titre du commentaire, son auteur et le billet associé -->
        Commentaire : {{ item.headline }} - {{ item.user.username }} sur "{{ item.billet.title }}"
        <!-- Liens modification/suppression pour l’auteur du commentaire -->
        {% if item.user == request.user %}
          <a href="{% url 'billets:commentaire_modifier' item.pk %}">Modifier</a>
          <a href="{% url 'billets:commentaire_supprimer' item.pk %}">Supprimer</a>
        {% endif %}
      {% endif %}
      <br>
      <!-- Affiche la date de création formatée -->
      Publié le {{ item.time_created|date:"d/m/Y H:i" }}
    </li>
  {% empty %}
    <li>Aucune activité disponible.</li>
  {% endfor %}
</ul>

{% endblock %}